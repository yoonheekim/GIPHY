<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>GIPHY API</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" media="screen" href="assets/css/style.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>
<body>

    <div class = "container text-monospace">
        <header class = "row top">
            <div id="buttons_display" class="col-md-12"></div>
            <div class="col-md-12">
                <button type='button' class='add btn btn-success btn-sm disabled'>ADD 10 gifs more</button>
            </div>


        </header>
        <div class = "row">
            <div id="submit_area" class = "col-md-3 order-md-12">
                <form>
                    <div class="form-group">
                        <label for="input_search">Add an animal</label>
                        <input type="text" class="form-control" id="input_search" placeholder="">
                    </div>
                    <button id="submit" type="submit" class="btn btn-outline-secondary">Submit</button>
                    <br><br>
                    <button type='button' class='add btn btn-warning btn-sm'>FAVORITE</button>
                </form>
            </div>
            <div id="img_display" class = "col-md-9 order-md-1 card-columns">
                <div class="card" style="width: 18rem;">
                    <a href="https://media3.giphy.com/media/WsVJuYCz6qgJG/200.gif?cid=e1bb72ff5c144dc74e695a754936037a" download>
                        <img class="card-img-top" src="https://media0.giphy.com/media/JIX9t2j0ZTN9S/200.gif?cid=e1bb72ff5c1433c9494661592e5349ba" alt="Card image cap"></a>
                    <div class="card-body">
                        <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                    </div>
                </div>
            </div>
            

        </div>
    </div>



    <script>



        var GIPHY = {

            topics: ["dog", "cat"],
            addButton: false,
            data: "",
            limits: 10,
            
            make_buttons: function(){
                $("#buttons_display").empty();

                for(var  i=0; i<GIPHY.topics.length; i++){
                    //<button type='button' class='btn btn-outline-secondary'>Secondary</button>
                    var button = $("<button type='button' class='btn-data btn btn-outline-secondary'>"+GIPHY.topics[i]+"</button>");
                    button.attr("data-name", GIPHY.topics[i]);
                    $("#buttons_display").append(button);
                }
            },

            change_state: function(){
                console.log(this);
                if($(this).attr("img-state")==="still"){
                    $(this).attr("img-state", "active");
                    $("img", this).attr("src", $(this).attr("img-active"));
                } else {
                    $(this).attr("img-state", "still");
                    $("img", this).attr("src", $(this).attr("img-still"));
                }
            },

            button_click: function(){
                $(".add").removeClass("disabled");
                GIPHY.addButton = true;
                //console.log(this);
                GIPHY.limits = 10;
                GIPHY.data = $(this).attr("data-name");
                var queryURL = "https://api.giphy.com/v1/gifs/search?q=" +
                    GIPHY.data + "&api_key=dc6zaTOxFJmzC&limit=" + parseInt(GIPHY.limits);
                //console.log(queryURL);
                GIPHY.GIPHY_API(queryURL);

            },

            add_click: function(){
                if(GIPHY.addButton){
                    GIPHY.limits += 10;
                    var queryURL = "https://api.giphy.com/v1/gifs/search?q=" +
                    GIPHY.data + "&api_key=dc6zaTOxFJmzC&limit=" + parseInt(GIPHY.limits);
                    GIPHY.GIPHY_API(queryURL);
                }
            },


            GIPHY_API: function(queryURL){
                $("#img_display").empty();
                $.ajax({
                    url: queryURL,
                    method: "GET"
                }).then(function(response){
                    console.log(response);
                    for(var i=0; i<response.data.length; i++){
                        var div = $("<div>");
                        var body_div = $("<div>");
                        var body_p = $("<p>");
                        div.attr("class","img_div card").attr("img-state", "still")//.attr("style","width: 18rem;");

                        div.attr("img-still", response.data[i].images.fixed_height_still.url);
                        div.attr("img-active", response.data[i].images.fixed_height.url);
                        div.append("<img class='card-img-top' src='"+response.data[i].images.fixed_height_still.url+"'><br>");//style='height: 200px; width: auto;'
                        body_div.attr("class", "card-body");
                        body_p.attr("class", "card-text");

                        body_p.append("Title : "+response.data[i].title+"<br>");
                        body_p.append("Rating : "+response.data[i].rating+"<br>");
                        body_p.append("<button type='button' class='download btn btn-sm btn-outline-info'>Download</button><br>");
                        body_p.append("<button type='button' class='addFavorite btn btn-outline-warning btn-sm'>Add Favorite</button>");
                        body_div.append(body_p);
                        div.append(body_div);
                        $("#img_display").append(div);


                        // <div class="card">//
                        //     <img class="card-img-top" style="height: 18rem;" src="https://media0.giphy.com/media/JIX9t2j0ZTN9S/200.gif?cid=e1bb72ff5c1433c9494661592e5349ba" alt="Card image cap">//
                        //     <div class="card-body">
                        //         <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                        //     </div>
                        // </div>

                    }
                

                }).catch((err) => {
                    console.log("error : ")
                });
            }
        }

        $(document).ready(function(){
            GIPHY.make_buttons();
            $(document).on("click", ".img_div", GIPHY.change_state);
            $(document).on("click", ".btn-data", GIPHY.button_click);
            $(document).on("click", ".add", GIPHY.add_click);
        });



        $("#submit").on("click", function(){
            event.preventDefault();


            var search = $("#input_search").val().trim();
            GIPHY.topics.push(search);
            GIPHY.make_buttons();
            $("#input_search").val("");
        });

        

        




    
    </script>

    
</body>
</html>